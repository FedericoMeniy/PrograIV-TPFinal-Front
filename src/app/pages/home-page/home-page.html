<div class="content-area">

    <section class="banner-principal">
        <div class="banner-texto">
            <h1>TU PRÓXIMO COCHE. HOY</h1>

            <div class="banner-acciones">
              @if (!mostrarBuscador) {
                <a (click)="onBuscarClick($event)" href="#" class="boton-accion">BUSCAR MI AUTO</a>
              } @else {
                <form class="banner-buscador" (ngSubmit)="onBusquedaSubmit()">
                  <input type="text" 
                         placeholder="Buscar por marca, modelo..."
                         [(ngModel)]="terminoBusqueda"
                         name="busqueda">
                  <button type="submit">
                    <i class="fa-solid fa-magnifying-glass"></i>
                  </button>
                </form>
              }

              @if (isAdmin) {
                <button type="button"
                        class="boton-accion boton-accion--crear"
                        (click)="onCrearPublicacionClick()">
                  CREAR PUBLICACIÓN
                </button>
              }
            </div>
        </div>

        <div class="banner-lateral">
        </div>
    </section>

    <section class="listings">
        <div class="listings-header">
            <h2>Fichas de Auto</h2>
        </div>
        
        @if (cargando) {
          <div class="loading-container" style="padding: 20px; text-align: center;">
            <p>Cargando inventario...</p>
            </div>
        } @else {
          <div class="card-container">
            
            @for (publi of publicacionesMostradas; track publi.id) {
              <a (click)="onVerFicha($event, publi)" href="#" class="car-card">
                
                <div class="card-image">
                    <img 
                      [src]="getImageUrl(publi.auto.imagenesUrl?.[0])" 
                      alt="Foto de {{ publi.auto.marca }} {{ publi.auto.modelo }}"
                      style="width: 100%; height: 200px; object-fit: cover;">
                </div>
                <div class="card-content">
                  <h3 class="card-title">{{ publi.auto.marca }} {{ publi.auto.modelo }}</h3>
                  
                  <p class="card-price">$ {{ publi.auto.precio.toLocaleString('es-AR') }}</p>
                  
                  <p class="card-details">
                    {{ publi.auto.anio }} | {{ publi.auto.km }} km
                  </p>
                  
                  <p class="card-brand">{{ publi.auto.marca }}</p>
                </div>
              </a>
            } @empty {
              <p style="padding: 20px;">No se encontraron publicaciones.</p>
            }
          </div>
        }
    </section>

    @if (publicacionSeleccionada) {
      <app-ficha-detalle 
        [publicacion]="publicacionSeleccionada"
        [esTienda]="true"
        (cerrar)="onCerrarModal()"
        (reservar)="onReservarClick($event)">
      </app-ficha-detalle>
    }

    @if (publicacionParaReservar) {
      <app-modal-reserva
        [publicacion]="publicacionParaReservar"
        (cerrar)="onCerrarModalReserva()">
      </app-modal-reserva>
    }

</div>